Version 4
SHEET 1 2264 1000
WIRE -432 -144 -432 -240
WIRE -320 -144 -320 -240
WIRE 2048 -48 1360 -48
WIRE 400 -32 -128 -32
WIRE 320 0 208 0
WIRE 1664 0 1520 0
WIRE 128 16 0 16
WIRE 0 48 0 16
WIRE 320 64 320 0
WIRE 400 64 400 -32
WIRE 1440 80 1440 64
WIRE 1520 80 1520 0
WIRE 1520 80 1440 80
WIRE -64 96 -64 48
WIRE -48 96 -64 96
WIRE 272 112 272 96
WIRE 1440 112 1440 80
WIRE 48 128 48 112
WIRE 240 128 224 128
WIRE 656 128 656 32
WIRE 1360 128 1360 -48
WIRE 1408 128 1360 128
WIRE -576 144 -576 112
WIRE -128 144 -128 -32
WIRE -48 144 -48 96
WIRE 16 144 -48 144
WIRE 400 144 400 64
WIRE 400 144 304 144
WIRE 624 144 576 144
WIRE 1600 144 1600 48
WIRE 1600 144 1472 144
WIRE 1664 144 1664 96
WIRE 2048 144 2048 -48
WIRE 2048 144 1664 144
WIRE 2176 144 2048 144
WIRE 2208 144 2176 144
WIRE 128 160 128 16
WIRE 128 160 80 160
WIRE 208 160 208 0
WIRE 240 160 208 160
WIRE 816 160 688 160
WIRE 1408 160 1360 160
WIRE 16 176 -32 176
WIRE 624 176 576 176
WIRE 896 176 896 160
WIRE 1664 176 1664 144
WIRE 272 192 272 176
WIRE 48 208 48 192
WIRE 1440 208 1440 176
WIRE 1568 208 1440 208
WIRE 1440 224 1440 208
WIRE 224 240 224 128
WIRE 656 256 656 192
WIRE 128 272 128 160
WIRE 896 272 896 256
WIRE 1360 272 1360 160
WIRE 1360 272 896 272
WIRE -576 288 -576 224
WIRE 896 288 896 272
WIRE 1568 320 1568 208
WIRE 1664 320 1664 272
WIRE 1664 320 1568 320
WIRE 1600 336 1600 144
WIRE 1728 336 1728 224
WIRE 1728 336 1600 336
WIRE -448 368 -576 368
WIRE -576 384 -576 368
WIRE 896 432 896 368
WIRE -576 496 -576 464
WIRE 896 528 896 512
FLAG -432 -64 0
FLAG -432 -240 VPS
FLAG 48 112 VPS
FLAG 272 96 VPS
FLAG -320 -64 0
FLAG -320 -240 -VPS
FLAG 896 528 0
FLAG 576 176 VTriang
FLAG 128 272 VTriang
FLAG -32 256 0
FLAG 224 320 0
FLAG 48 208 -VPS
FLAG 272 192 -VPS
FLAG -576 496 0
FLAG -576 112 VPS
FLAG 656 32 VPS
FLAG 656 256 -VPS
FLAG 576 144 VIN
FLAG -448 368 VIN
FLAG 2208 144 out
FLAG 2176 224 0
FLAG 1440 64 VPS
FLAG 1440 224 -VPS
SYMBOL res 224 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -50 58 VTop 2
SYMATTR InstName R1
SYMATTR Value {mc(2k,tol2)}
SYMBOL res -32 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R
SYMATTR Value {mc(8.06k,tol2)}
SYMBOL res 416 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {mc(4.02k,tol3)}
SYMBOL cap 0 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {mc(5.1n,tol7)}
SYMBOL voltage -432 -160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VPS
SYMATTR Value 6
SYMBOL voltage -320 -160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName -VPS
SYMATTR Value -6
SYMBOL res -48 160 R0
WINDOW 0 -49 58 Left 2
WINDOW 3 -71 88 Left 2
SYMATTR InstName R5
SYMATTR Value {mc(8.06k,tol2)}
SYMBOL res 208 224 R0
SYMATTR InstName R6
SYMATTR Value {mc(1.35k,tol4)}
SYMBOL res -592 128 R0
SYMATTR InstName R4
SYMATTR Value {mc(1.5k,tol5)}
SYMBOL res -592 272 R0
SYMATTR InstName R7_1
SYMATTR Value {mc({1k*duty_cycle+0.000001},tol1)}
SYMBOL res -592 368 R0
SYMATTR InstName R7_2
SYMATTR Value {mc({1k*(1-duty_cycle)+0.000001},tol1)}
SYMBOL OpAmps\\AD8031 48 96 R0
SYMATTR InstName U1
SYMBOL OpAmps\\AD8031 272 80 R0
SYMATTR InstName U2
SYMBOL res 880 416 R0
SYMATTR InstName R3
SYMATTR Value {mc(1.5k,tol5)}
SYMBOL res 880 272 R0
SYMATTR InstName R8_2
SYMATTR Value {mc({1k*ampl+0.000001},tol1)}
SYMBOL res 880 160 R0
SYMATTR InstName R8_1
SYMATTR Value {mc({1k*(1-ampl)+0.000001},tol1)}
SYMBOL res 2160 128 R0
SYMATTR InstName Rout
SYMATTR Value 50
SYMBOL OpAmps\\AD8031 1440 80 R0
SYMATTR InstName U4
SYMBOL res 912 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value {mc(0.5k,tol6)}
SYMBOL pnp 1728 272 R180
SYMATTR InstName Q1
SYMATTR Value 2N2907
SYMBOL npn 1600 0 R0
SYMATTR InstName Q2
SYMATTR Value 2N2222
SYMBOL OpAmps\\AD8067 656 96 R0
SYMATTR InstName U3
TEXT 160 656 Left 2 !.tran 0 3ms 0 20us
TEXT -456 520 Left 2 !.param duty_cycle 0
TEXT 1032 448 Left 2 !.param ampl 1
TEXT 640 704 Left 2 !.meas tran amplitude_VIN max V(vin)
TEXT 640 664 Left 2 !.meas tran amplitude max V(out)
TEXT 248 480 Left 2 ;.step param run 1 25 1
TEXT -504 680 Left 2 !.param tol1=0.2
TEXT -504 728 Left 2 !.param tol2=0.005
TEXT -504 776 Left 2 !.param tol3=0.0005
TEXT -496 824 Left 2 !.param tol4=0.05
TEXT -496 872 Left 2 !.param tol5=0.01
TEXT -488 928 Left 2 !.param tol6=0.001
TEXT -472 984 Left 2 !.param tol7=0.1
TEXT 648 784 Left 2 !.meas tran t1 V(out) when V(out)=0 rise=2
TEXT 648 832 Left 2 !.meas tran t2 V(out) when V(out)=0 fall=2
TEXT 648 920 Left 2 !.meas tran freq param 1/(t3-t1)
TEXT -488 568 Left 2 ;.step param duty_cycle 0 1 0.2
TEXT 1032 504 Left 2 ;.step param ampl 0 1 0.1
TEXT 648 880 Left 2 !.meas tran t3 V(out) when V(out)=0 rise=3
TEXT 656 968 Left 2 !.meas tran amplVTriang max V(VTriang)
TEXT 648 744 Left 2 !.meas tran dutyCycle param (t2-t1)/(t3-t1)*100
